{% extends "base.html" %}

{% block content %}
<div class="container" style="padding: 1rem 1rem;">
    <div style="margin-bottom: 2rem;">

        <div style="display: flex; justify-content: space-between; align-items: flex-end; flex-wrap: wrap; gap: 1rem;">
            <div style="text-align: left;">
                <h2 style="font-size: 2rem; font-weight: 700; color: #1a1a2e; margin-bottom: 0.5rem;">
                    <i class="fas fa-calendar-check"></i> My Appointments
                </h2>
                <p style="color: #6b7280; font-size: 1rem; margin: 0;">Manage all your scheduled appointments</p>
            </div>
            <a href="{{ url_for('doctors') }}" class="btn btn-primary"
                style="border-radius: 25px; padding: 0.5rem 1.5rem;">
                <i class="fas fa-plus"></i> Book New Appointment
            </a>
        </div>
    </div>

    <div>
        <!-- Filter Tabs -->
        <div class="appointment-filters">
            <button class="filter-btn active" data-filter="all">
                <i class="fas fa-list"></i> All Appointments
            </button>
            <button class="filter-btn" data-filter="scheduled">
                <i class="fas fa-clock"></i> Scheduled
            </button>
            <button class="filter-btn" data-filter="confirmed">
                <i class="fas fa-check-circle"></i> Confirmed
            </button>
            <button class="filter-btn" data-filter="completed">
                <i class="fas fa-check-double"></i> Completed
            </button>
            <button class="filter-btn" data-filter="cancelled">
                <i class="fas fa-times-circle"></i> Cancelled
            </button>
        </div>

        <!-- Appointments List -->
        <div class="appointments-list-full">
            {% if appointments %}
            {% for appt in appointments %}
            <div class="appointment-card-full" data-status="{{ appt.status.lower() }}">
                <div class="appointment-card-header">
                    <div class="doctor-info-full">
                        <div class="doctor-avatar-small">
                            {% set doctor = appt.doctor_profile if appt.doctor_profile else None %}
                            {% if doctor and doctor.image_url %}
                            <img src="{{ doctor.image_url }}" alt="{{ doctor.user.username if doctor else 'Doctor' }}">
                            {% else %}
                            <i class="fas fa-user-md"></i>
                            {% endif %}
                        </div>
                        <div class="doctor-details-full">
                            <h3>{{ doctor.user.username if doctor else 'Doctor' }}</h3>
                            <p class="specialization">{{ doctor.specialization if doctor else 'General' }}</p>
                            <p class="hospital"><i class="fas fa-hospital"></i> {{ doctor.hospital if doctor else
                                'Hospital' }}</p>
                        </div>
                    </div>
                    <div class="appointment-status-full">
                        <span class="status-badge-large {{ appt.status.lower() }}">
                            {% if appt.status == 'Scheduled' %}
                            <i class="fas fa-clock"></i>
                            {% elif appt.status == 'Confirmed' %}
                            <i class="fas fa-check-circle"></i>
                            {% elif appt.status == 'Completed' %}
                            <i class="fas fa-check-double"></i>
                            {% elif appt.status == 'Cancelled' %}
                            <i class="fas fa-times-circle"></i>
                            {% endif %}
                            {{ appt.status }}
                        </span>
                    </div>
                </div>

                <div class="appointment-card-body">
                    <div class="appointment-details-grid">
                        <div class="detail-box">
                            <i class="fas fa-calendar"></i>
                            <div>
                                <span class="detail-label">Date</span>
                                <span class="detail-value">{{ appt.date_time.strftime('%B %d, %Y') }}</span>
                            </div>
                        </div>
                        <div class="detail-box">
                            <i class="fas fa-clock"></i>
                            <div>
                                <span class="detail-label">Time</span>
                                <span class="detail-value">{{ appt.date_time.strftime('%I:%M %p') }}</span>
                            </div>
                        </div>
                        <div class="detail-box">
                            <i class="fas fa-notes-medical"></i>
                            <div>
                                <span class="detail-label">Type</span>
                                <span class="detail-value">{{ appt.consultation_type.title() if appt.consultation_type
                                    else 'General
                                    Consultation' }}</span>
                            </div>
                        </div>
                        <div class="detail-box">
                            <i class="fas fa-rupee-sign"></i>
                            <div>
                                <span class="detail-label">Fee</span>
                                <span class="detail-value">₹{{ appt.consultation_fee }}</span>
                            </div>
                        </div>
                    </div>

                    {% if appt.notes %}
                    <div class="appointment-notes">
                        <h4><i class="fas fa-sticky-note"></i> Notes</h4>
                        <p>{{ appt.notes }}</p>
                    </div>
                    {% endif %}
                </div>

                <div class="appointment-card-footer">
                    <div class="appointment-id">
                        <small>Appointment ID: #{{ appt.id }}</small>
                    </div>
                    <div class="appointment-actions-full">
                        {% if appt.status == 'Scheduled' and appt.consultation_type == 'video' %}
                        <button class="btn-action-full video"
                            onclick="startVideoCall({{ appt.id }}, '{{ appt.doctor_profile.user.username if appt.doctor_profile else 'Doctor' }}')">
                            <i class="fas fa-video"></i> Join Video Call
                        </button>
                        {% endif %}
                        {% if appt.status != 'Cancelled' and appt.status != 'Completed' %}
                        <button class="btn-action-full view"
                            onclick="viewAppointmentDetails({{ appt.id }}, '{{ appt.doctor_profile.user.username if appt.doctor_profile else 'Doctor' }}', '{{ appt.doctor_profile.specialization if appt.doctor_profile else 'General' }}', '{{ appt.date_time.strftime('%B %d, %Y') }}', '{{ appt.date_time.strftime('%I:%M %p') }}', '{{ appt.consultation_type.title() if appt.consultation_type else 'General Consultation' }}', '₹{{ appt.consultation_fee }}', '{{ appt.notes|replace('\n', ' ')|replace("'", "\\'") if appt.notes else '' }}')">
                            <i class="fas fa-eye"></i> View Details
                        </button>
                        <button class="btn-action-full reschedule" onclick="rescheduleAppointment({{ appt.id }})">
                            <i class="fas fa-calendar-alt"></i> Reschedule
                        </button>
                        <button class="btn-action-full cancel" onclick="cancelAppointment({{ appt.id }})">
                            <i class="fas fa-times-circle"></i> Cancel
                        </button>
                        {% endif %}
                        {% if appt.video_prescription %}
                        <button class="btn-action-full prescription"
                            onclick='viewPrescription("{{ appt.video_prescription.diagnosis|replace("\n", " ")|replace("\"", "&quot;")|safe }}", {{ appt.video_prescription.medications|safe }}, "{{ appt.video_prescription.notes|replace("\n", " ")|replace("\"", "&quot;")|safe }}")'>
                            <i class="fas fa-file-prescription"></i> View Prescription
                        </button>
                        {% endif %}
                        {% if appt.status == 'Cancelled' or appt.status == 'Completed' %}
                        <button class="btn-action-full delete" onclick="deleteAppointment({{ appt.id }})">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="empty-state-full">
                <i class="fas fa-calendar-times"></i>
                <h3>No Appointments Found</h3>
                <p>You haven't scheduled any appointments yet</p>
                <a href="{{ url_for('doctors') }}" class="btn btn-primary btn-lg">
                    <i class="fas fa-plus"></i> Book Your First Appointment
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
    .appointments-management-container {
        min-height: 100vh;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        padding-bottom: 3rem;
    }

    .appointments-header {
        background: linear-gradient(135deg, #2E8B57 0%, #3CB371 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
    }

    .header-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .header-info h1 {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .header-info p {
        font-size: 1.1rem;
        opacity: 0.9;
    }

    .appointment-filters {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
    }

    .filter-btn {
        padding: 0.75rem 1.5rem;
        background: white;
        border: 2px solid #e2e8f0;
        border-radius: 50px;
        color: #6b7280;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .filter-btn:hover {
        border-color: #2E8B57;
        color: #2E8B57;
    }

    .filter-btn.active {
        background: linear-gradient(135deg, #2E8B57, #3CB371);
        border-color: #2E8B57;
        color: white;
    }

    .appointments-list-full {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .appointment-card-full {
        background: white;
        border-radius: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .appointment-card-full:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    }

    .appointment-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem 2rem;
        background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        border-bottom: 2px solid #e2e8f0;
    }

    .doctor-info-full {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .doctor-avatar-small {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: #2E8B57;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
        overflow: hidden;
    }

    .doctor-avatar-small img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .doctor-details-full h3 {
        font-size: 1.3rem;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 0.25rem;
    }

    .doctor-details-full .specialization {
        color: #2E8B57;
        font-weight: 600;
        margin-bottom: 0.25rem;
    }

    .doctor-details-full .hospital {
        color: #6b7280;
        font-size: 0.9rem;
    }

    .status-badge-large {
        padding: 0.75rem 1.5rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .status-badge-large.scheduled {
        background: #dbeafe;
        color: #1d4ed8;
    }

    .status-badge-large.confirmed {
        background: #dcfce7;
        color: #166534;
    }

    .status-badge-large.completed {
        background: #e0e7ff;
        color: #3730a3;
    }

    .status-badge-large.cancelled {
        background: #fee2e2;
        color: #991b1b;
    }

    .appointment-card-body {
        padding: 2rem;
    }

    .appointment-details-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .detail-box {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: #f8fafc;
        border-radius: 12px;
    }

    .detail-box i {
        font-size: 1.5rem;
        color: #2E8B57;
    }

    .detail-label {
        display: block;
        font-size: 0.8rem;
        color: #6b7280;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .detail-value {
        display: block;
        font-size: 1rem;
        font-weight: 700;
        color: #1f2937;
    }

    .appointment-notes {
        padding: 1rem;
        background: #fffbeb;
        border-left: 4px solid #f59e0b;
        border-radius: 8px;
    }

    .appointment-notes h4 {
        font-size: 1rem;
        font-weight: 700;
        color: #92400e;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .appointment-notes p {
        color: #78350f;
    }

    .appointment-card-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem 2rem;
        background: #f8fafc;
        border-top: 2px solid #e2e8f0;
    }

    .appointment-id small {
        color: #6b7280;
        font-weight: 600;
    }

    .appointment-actions-full {
        display: flex;
        gap: 0.75rem;
    }

    .btn-action-full {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-action-full:hover {
        transform: translateY(-2px);
    }

    .btn-action-full.video {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
    }

    .btn-action-full.video:hover {
        background: linear-gradient(135deg, #059669, #047857);
        transform: translateY(-2px);
    }

    .btn-action-full.view {
        background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        color: white;
    }

    .btn-action-full.view:hover {
        box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
    }

    .btn-action-full.reschedule {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        color: white;
    }

    .btn-action-full.reschedule:hover {
        box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
    }

    .btn-action-full.cancel {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
    }

    .btn-action-full.cancel:hover {
        box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
    }

    .btn-action-full.delete {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
    }

    .btn-action-full.delete:hover {
        box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
    }

    .btn-action-full.prescription {
        background: linear-gradient(135deg, #0ea5e9, #0284c7);
        color: white;
    }

    .btn-action-full.prescription:hover {
        box-shadow: 0 4px 15px rgba(14, 165, 233, 0.4);
    }

    .empty-state-full {
        text-align: center;
        padding: 5rem 2rem;
        background: white;
        border-radius: 20px;
    }

    .empty-state-full i {
        font-size: 5rem;
        color: #d1d5db;
        margin-bottom: 1.5rem;
    }

    .empty-state-full h3 {
        font-size: 2rem;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 0.5rem;
    }

    .empty-state-full p {
        font-size: 1.1rem;
        color: #6b7280;
        margin-bottom: 2rem;
    }

    @media (max-width: 768px) {
        .header-content {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
        }

        .appointment-details-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .appointment-actions-full {
            flex-direction: column;
            width: 100%;
        }

        .btn-action-full {
            width: 100%;
            justify-content: center;
        }
    }
</style>

<!-- View Details Modal -->
<div class="modal fade" id="viewDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
            <div class="modal-header border-0 bg-primary text-white"
                style="border-radius: 20px 20px 0 0; background: linear-gradient(135deg, #2E8B57, #3CB371) !important;">
                <h5 class="modal-title fw-bold"><i class="fas fa-info-circle me-2"></i>Appointment Details</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center mb-4">
                    <div class="mx-auto mb-3 d-flex align-items-center justify-content-center text-white fw-bold display-5"
                        style="width: 80px; height: 80px; background: #2E8B57; border-radius: 50%;">
                        <i class="fas fa-user-md"></i>
                    </div>
                    <h4 id="modalDoctorName" class="fw-bold mb-1">Dr. Name</h4>
                    <p id="modalSpecialization" class="text-muted mb-0">Specialization</p>
                </div>

                <div class="row g-3">
                    <div class="col-6">
                        <div class="p-3 bg-light rounded-3">
                            <small class="text-uppercase text-muted fw-bold" style="font-size: 0.7rem;">Date</small>
                            <div id="modalDate" class="fw-bold text-dark">Date</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="p-3 bg-light rounded-3">
                            <small class="text-uppercase text-muted fw-bold" style="font-size: 0.7rem;">Time</small>
                            <div id="modalTime" class="fw-bold text-dark">Time</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="p-3 bg-light rounded-3">
                            <small class="text-uppercase text-muted fw-bold" style="font-size: 0.7rem;">Type</small>
                            <div id="modalType" class="fw-bold text-dark">Type</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="p-3 bg-light rounded-3">
                            <small class="text-uppercase text-muted fw-bold" style="font-size: 0.7rem;">Fee</small>
                            <div id="modalFee" class="fw-bold text-dark">₹500</div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="p-3 bg-light rounded-3">
                            <small class="text-uppercase text-muted fw-bold" style="font-size: 0.7rem;">Notes</small>
                            <div id="modalNotes" class="text-dark">Notes content</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 p-3 bg-light" style="border-radius: 0 0 20px 20px;">
                <button type="button" class="btn btn-secondary rounded-pill px-4" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary rounded-pill px-4"
                    onclick="alert('Reschedule feature coming in next update!')">Reschedule</button>
            </div>
        </div>
    </div>
</div>

<!-- Video Call Modal -->
<div class="modal fade" id="videoCallModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
            <div class="modal-body p-5 text-center">
                <div id="videoConnectingState">
                    <div class="spinner-border text-primary mb-4" style="width: 3rem; height: 3rem;" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <h4 class="fw-bold mb-2">Connecting to Doctor...</h4>
                    <p class="text-muted">Please wait while we establish a secure connection.</p>
                </div>

                <div id="videoConnectedState" style="display: none;">
                    <div class="mb-4 text-success display-4">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h4 class="fw-bold mb-2">Request Sent Successfully!</h4>
                    <p class="text-muted mb-4">The doctor has been notified and will get back to you shortly via video
                        call link on your registered email.</p>
                    <button type="button" class="btn btn-primary rounded-pill px-5 py-2" data-bs-dismiss="modal">
                        Okay, Got it
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Prescription Modal -->
<div class="modal fade" id="prescriptionModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
            <div class="modal-header border-0 text-white"
                style="border-radius: 20px 20px 0 0; background: linear-gradient(135deg, #0ea5e9, #0284c7);">
                <h5 class="modal-title fw-bold"><i class="fas fa-file-prescription me-2"></i>Prescription Details</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="mb-4">
                    <h6 class="text-uppercase text-muted fw-bold small">Diagnosis</h6>
                    <div id="prescDiagnosis" class="p-3 bg-light rounded-3 fw-bold text-dark"></div>
                </div>

                <div class="mb-4">
                    <h6 class="text-uppercase text-muted fw-bold small">Medications</h6>
                    <div id="prescMedications" class="d-flex flex-column gap-2">
                        <!-- Meds injected here -->
                    </div>
                </div>

                <div>
                    <h6 class="text-uppercase text-muted fw-bold small">Notes</h6>
                    <div id="prescNotes" class="p-3 bg-light rounded-3 text-dark"></div>
                </div>
            </div>
            <div class="modal-footer border-0 p-3 bg-light" style="border-radius: 0 0 20px 20px;">
                <button type="button" class="btn btn-secondary rounded-pill px-4" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary rounded-pill px-4" onclick="window.print()">
                    <i class="fas fa-print me-2"></i> Print
                </button>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='vendor/bootstrap/bootstrap.bundle.min.js') }}"></script>
<script>
    // Start video call simulation
    function startVideoCall(appointmentId, doctorName) {
        const modalEl = document.getElementById('videoCallModal');
        const modal = new bootstrap.Modal(modalEl);

        // Reset state
        document.getElementById('videoConnectingState').style.display = 'block';
        document.getElementById('videoConnectedState').style.display = 'none';

        modal.show();

        // Simulate connection delay
        setTimeout(() => {
            document.getElementById('videoConnectingState').style.display = 'none';
            document.getElementById('videoConnectedState').style.display = 'block';
        }, 3000); // 3 seconds delay
    }

    // View Appointment Details
    function viewAppointmentDetails(id, doctorName, specialization, date, time, type, fee, notes) {
        document.getElementById('modalDoctorName').textContent = doctorName || 'Doctor';
        document.getElementById('modalSpecialization').textContent = specialization || 'General';
        document.getElementById('modalDate').textContent = date;
        document.getElementById('modalTime').textContent = time;
        document.getElementById('modalType').textContent = type;
        document.getElementById('modalFee').textContent = fee;
        document.getElementById('modalNotes').textContent = notes || 'No notes provided';

        const modal = new bootstrap.Modal(document.getElementById('viewDetailsModal'));
        modal.show();
    }

    // Filter appointments
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', function () {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');

            const filter = this.dataset.filter;
            const appointments = document.querySelectorAll('.appointment-card-full');

            appointments.forEach(appt => {
                if (filter === 'all' || appt.dataset.status === filter) {
                    appt.style.display = 'block';
                } else {
                    appt.style.display = 'none';
                }
            });
        });
    });

    // Appointment Management Functions
    function rescheduleAppointment(appointmentId) {
        if (confirm('Do you want to reschedule this appointment?')) {
            window.location.href = `/appointment/reschedule/${appointmentId}`;
        }
    }

    function cancelAppointment(appointmentId) {
        if (confirm('Are you sure you want to cancel this appointment?')) {
            window.location.href = `/appointment/cancel/${appointmentId}`;
        }
    }

    function deleteAppointment(appointmentId) {
        if (confirm('Are you sure you want to permanently delete this appointment? History will be lost.')) {
            window.location.href = `/appointment/delete/${appointmentId}`;
        }
    }

    function viewPrescription(diagnosis, medications, notes) {
        document.getElementById('prescDiagnosis').textContent = diagnosis;
        document.getElementById('prescNotes').textContent = notes;

        const medsContainer = document.getElementById('prescMedications');
        medsContainer.innerHTML = '';

        if (Array.isArray(medications)) {
            medications.forEach(med => {
                const el = document.createElement('div');
                el.className = 'p-3 bg-white border rounded-3 shadow-sm';
                el.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-1 fw-bold text-primary">${med.name}</h6>
                        <span class="badge bg-secondary">${med.dosage}</span>
                    </div>
                    <p class="mb-0 text-muted small"><i class="fas fa-info-circle me-1"></i>${med.instructions}</p>
                `;
                medsContainer.appendChild(el);
            });
        }

        const modal = new bootstrap.Modal(document.getElementById('prescriptionModal'));
        modal.show();
    }
</script>
</div>
{% endblock %}